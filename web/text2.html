<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>URL Text & OG Extractor</title>
<style>
body{font-family:Arial,sans-serif;max-width:900px;margin:auto;padding:20px;background:#f5f5f5}
.card{background:#fff;padding:20px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.1)}
input,button{width:100%;padding:12px;margin-top:10px;font-size:16px;border-radius:8px;border:1px solid #ccc}
button{cursor:pointer;font-weight:bold}
#result{margin-top:20px}
#ogImage{max-width:100%;margin-top:10px;border-radius:8px}
textarea{width:100%;min-height:250px;margin-top:10px;padding:10px;border-radius:8px;border:1px solid #ccc;font-size:14px}
.label{font-weight:bold;margin-top:15px;display:block}
.preview{border:1px solid #ddd;padding:15px;border-radius:8px;margin-top:10px;white-space:normal;line-height:1.6}
.copyBtn{background:#111;color:#fff;border:none;margin-top:8px}
</style>
</head>
<body>
<div class="card">
<h2>URL Extractor (Text + OG Title + OG Image)</h2>
<input id="urlInput" placeholder="Zalijepi URL...">
<button onclick="loadData()">UÄitaj sadrÅ¾aj</button>
<div id="result"></div>
</div>

<script>
const endings = [
  "NASTAVAK PRIÄŒE U KOMENTARU ğŸ‘‡ğŸ‘‡ğŸ‘‡",
  "ÄŒITAJ dalje u komentaru  ğŸ‘‡ğŸ‘‡ğŸ‘‡",
  "OSTATAK PRICE PROCITAJTE NA LINKU U KOMENTARU â¬‡ï¸â¬‡ï¸â¬‡ï¸",
  "NASTAVAK U KOMENTARU  ğŸ‘‡ğŸ‘‡ğŸ‘‡",
  "ÄŒITAJTE NA LINKU U KOMENTARU ğŸ‘‡ğŸ‘‡ğŸ‘‡"
];

async function loadData(){
  const url=document.getElementById('urlInput').value.trim();
  if(!url) return alert('Unesi URL');

  const proxy=`https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`;
  const res=await fetch(proxy);
  const html=await res.text();
  const parser=new DOMParser();
  const doc=parser.parseFromString(html,'text/html');

  // OG DATA
  const ogTitle = doc.querySelector('meta[property="og:title"]')?.content || doc.title || '';
  const ogImage = doc.querySelector('meta[property="og:image"]')?.content || '';

  // CONTENT ROOT
  let contentDiv = doc.querySelector('.post-body.entry-content.float-container')
    || doc.querySelector('.entry-content')
    || doc.querySelector('article');

  let finalHTML = '';

  if(contentDiv){
    let clone = contentDiv.cloneNode(true);

    // STOP na <div class="nastavak"></div>  -> uzima se samo SVE PRIJE tog diva
    const stopEl = clone.querySelector('.nastavak');
    if(stopEl){
      // ukloni sve elemente poslije njega u parent kontejneru
      let parent = stopEl.parentNode;
      let found = false;
      Array.from(parent.childNodes).forEach(node=>{
        if(found) node.remove();
        if(node === stopEl) found = true;
      });
      // ukloni i sam nastavak div
      stopEl.remove();
    }

    // uklanjanje skripti/oglasa
    clone.querySelectorAll('script, style, iframe, ins, .adsbygoogle').forEach(e=>e.remove());

    finalHTML = clone.innerHTML;

    // ukloni banner tekst
    finalHTML = finalHTML.replace(/-\s*-\s*-\s*Tekst se nastavlja ispod oglasa\s*-\s*-\s*-/gi,'');

    // random zavrÅ¡na poruka
    const endMsg = endings[Math.floor(Math.random()*endings.length)];
    finalHTML += `<p><strong>${endMsg}</strong></p>`;

  } else {
    finalHTML = '<i>Nije pronaÄ‘en content div.</i>';
  }

  document.getElementById('result').innerHTML = `
    <span class='label'>OG Naslov:</span>
    <input id='ogTitleField' value="${ogTitle.replace(/"/g,'&quot;')}">
    <button class='copyBtn' onclick="copyText('ogTitleField')">Copy naslov</button>

    <span class='label'>OG Slika:</span>
    ${ogImage?`<img id='ogImage' src='${ogImage}'>`:'Nema OG slike'}
    ${ogImage?`<button class='copyBtn' onclick="copyRaw('${ogImage}')">Copy image URL</button>`:''}

    <span class='label'>Preview (formatirano kao na webu):</span>
    <div class='preview' id='previewBox'>${finalHTML}</div>
    <button class='copyBtn' onclick="copyHTML()">Copy tekst (HTML)</button>

    <span class='label'>HTML tekst:</span>
    <textarea id='htmlBox'>${finalHTML.replace(/</g,'&lt;').replace(/>/g,'&gt;')}</textarea>
    <button class='copyBtn' onclick="copyText('htmlBox')">Copy raw HTML</button>
  `;
}

function copyText(id){
  const el=document.getElementById(id);
  el.select();
  document.execCommand('copy');
}

function copyHTML(){
  const html = document.getElementById('previewBox').innerText;
  navigator.clipboard.writeText(html);
}

function copyRaw(text){
  navigator.clipboard.writeText(text);
}
</script>
</body>
</html>
