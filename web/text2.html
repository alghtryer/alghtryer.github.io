<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>URL Text & OG Extractor</title>
<style>
body{font-family:Arial,sans-serif;max-width:900px;margin:auto;padding:20px;background:#f5f5f5}
.card{background:#fff;padding:20px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.1)}
input,button{width:100%;padding:12px;margin-top:10px;font-size:16px;border-radius:8px;border:1px solid #ccc}
button{cursor:pointer;font-weight:bold}
#result{margin-top:20px}
#ogImage{max-width:100%;margin-top:10px;border-radius:8px}
textarea{width:100%;min-height:250px;margin-top:10px;padding:10px;border-radius:8px;border:1px solid #ccc;font-size:14px}
.label{font-weight:bold;margin-top:15px;display:block}
.preview{border:1px solid #ddd;padding:15px;border-radius:8px;margin-top:10px;white-space:normal;line-height:1.6}
</style>
</head>
<body>
<div class="card">
<h2>URL Extractor (Text + OG Title + OG Image)</h2>
<input id="urlInput" placeholder="Zalijepi URL...">
<input id="stopClass" placeholder="Klasa diva do kojeg se uzima tekst (npr: nastavak)">
<button onclick="loadData()">Učitaj sadržaj</button>
<div id="result"></div>
</div>

<script>
async function loadData(){
  const url=document.getElementById('urlInput').value.trim();
  const stopClass=document.getElementById('stopClass').value.trim();
  if(!url) return alert('Unesi URL');

  const proxy=`https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`;
  const res=await fetch(proxy);
  const html=await res.text();
  const parser=new DOMParser();
  const doc=parser.parseFromString(html,'text/html');

  // OG DATA
  const ogTitle = doc.querySelector('meta[property="og:title"]')?.content || doc.title || '';
  const ogImage = doc.querySelector('meta[property="og:image"]')?.content || '';

  // CONTENT ROOT
  let contentDiv = doc.querySelector('.post-body.entry-content.float-container')
    || doc.querySelector('.entry-content')
    || doc.querySelector('article');

  let finalHTML = '';

  if(contentDiv){
    let clone = contentDiv.cloneNode(true);

    // STOP DIV
    if(stopClass){
      const stopEl = clone.querySelector('.'+stopClass);
      if(stopEl){
        // ukloni sve poslije tog diva
        let node = stopEl.nextSibling;
        while(node){
          let next = node.nextSibling;
          node.remove();
          node = next;
        }
        stopEl.remove();
      }
    }

    // uklanjanje oglasa / separatora
    clone.querySelectorAll('script, style, iframe').forEach(e=>e.remove());

    finalHTML = clone.innerHTML;

    // ukloni banner tekst
    finalHTML = finalHTML.replace(/-\s*-\s*-\s*Tekst se nastavlja ispod oglasa\s*-\s*-\s*-/gi,'');
  } else {
    finalHTML = '<i>Nije pronađen content div.</i>';
  }

  document.getElementById('result').innerHTML = `
    <span class='label'>OG Naslov:</span>
    <input value="${ogTitle.replace(/"/g,'&quot;')}">

    <span class='label'>OG Slika:</span>
    ${ogImage?`<img id='ogImage' src='${ogImage}'>`:'Nema OG slike'}

    <span class='label'>Preview (formatirano kao na webu):</span>
    <div class='preview'>${finalHTML}</div>

    <span class='label'>HTML tekst:</span>
    <textarea>${finalHTML.replace(/</g,'&lt;').replace(/>/g,'&gt;')}</textarea>
  `;
}
</script>
</body>
</html>
