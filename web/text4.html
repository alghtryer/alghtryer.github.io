<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>URL Text & OG Extractor</title>
<style>
body{font-family:Arial,sans-serif;max-width:900px;margin:auto;padding:20px;background:#f5f5f5}
.card{background:#fff;padding:20px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.1);margin-top:20px}
input,button{width:100%;padding:12px;margin-top:10px;font-size:16px;border-radius:8px;border:1px solid #ccc}
button{cursor:pointer;font-weight:bold}
.label{font-weight:bold;margin-top:15px;display:block}
.preview{border:1px solid #ddd;padding:15px;border-radius:8px;margin-top:10px;line-height:1.6}
.copyBtn{background:#111;color:#fff;border:none;margin-top:8px}
</style>
</head>
<body>

<div class="card">
<h2>URL Extractor (Text + OG Title + OG Image)</h2>

<label><input type="radio" name="mode" value="manual" checked> Manual URL</label>
<label><input type="radio" name="mode" value="auto"> Auto ‚Äì zanimljivosti.xyz (FEED)</label>

<input id="urlInput" placeholder="Zalijepi URL...">
<input id="countInput" type="number" placeholder="Broj tekstova (npr. 5)" style="display:none">

<button onclick="loadData()">Uƒçitaj sadr≈æaj</button>

<div id="result"></div>
</div>

<script>

const endings=[
"NASTAVAK PRIƒåE U KOMENTARU üëáüëáüëá",
"ƒåITAJ dalje u komentaru üëáüëáüëá",
"OSTATAK PRICE PROCITAJTE NA LINKU U KOMENTARU ‚¨áÔ∏è‚¨áÔ∏è‚¨áÔ∏è",
"NASTAVAK U KOMENTARU üëáüëáüëá",
"ƒåITAJTE NA LINKU U KOMENTARU üëáüëáüëá"
];

document.querySelectorAll('input[name="mode"]').forEach(r=>{
r.addEventListener("change",()=>{
urlInput.style.display=r.value==="manual"?"block":"none";
countInput.style.display=r.value==="auto"?"block":"none";
});
});

async function loadData(){

result.innerHTML="";
const mode=document.querySelector('input[name="mode"]:checked').value;

if(mode==="manual"){
const url=urlInput.value.trim();
if(!url) return alert("Unesi URL");
await processSingle(url);
}

if(mode==="auto"){

const count=parseInt(countInput.value);
if(!count) return alert("Unesi broj tekstova");

const feedURL=`https://www.zanimljivosti.xyz/feeds/posts/default?alt=json&max-results=${count}`;
const proxy=`https://api.allorigins.win/raw?url=${encodeURIComponent(feedURL)}`;

const res=await fetch(proxy);
const data=await res.json();

const entries=data.feed.entry;

for(let entry of entries){

const title=entry.title.$t;

const linkObj=entry.link.find(l=>l.rel==="alternate");
const url=linkObj.href;

let content=entry.content?.$t || entry.summary?.$t || "";

let imgMatch=content.match(/<img[^>]+src="([^"]+)"/);
let image=imgMatch?imgMatch[1]:"";

processFeedPost(title,url,image,content);
}

}
}

function processFeedPost(title,url,image,content){

let container=document.createElement("div");
container.innerHTML=content;

// ukloni reklame
container.querySelectorAll('script,style,iframe,ins,.adsbygoogle').forEach(e=>e.remove());

let finalHTML=container.innerHTML;
finalHTML=finalHTML.replace(/-\s*-\s*-\s*Tekst se nastavlja ispod oglasa\s*-\s*-\s*-/gi,'');

const endMsg=endings[Math.floor(Math.random()*endings.length)];
finalHTML+=`<p><strong>${endMsg}</strong></p>`;

const box=document.createElement("div");
box.className="card";

box.innerHTML=`
<span class='label'>URL:</span>
<input value="${url}">
<button class='copyBtn' onclick="copyRaw('${url}')">Copy URL</button>

<span class='label'>Naslov:</span>
<input value="${title.replace(/"/g,'&quot;')}">
<button class='copyBtn' onclick="copyRaw('${title.replace(/"/g,'&quot;')}')">Copy naslov</button>

<span class='label'>Slika:</span>
${image?`<img src="${image}" style="max-width:100%">`:''}
${image?`<button class='copyBtn' onclick="copyRaw('${image}')">Copy image URL</button>`:''}

<span class='label'>Preview:</span>
<div class='preview'>${finalHTML}</div>

<span class='label'>HTML tekst:</span>
<textarea>${finalHTML.replace(/</g,'&lt;').replace(/>/g,'&gt;')}</textarea>
`;

result.appendChild(box);
}

async function processSingle(url){
const proxy=`https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`;
const res=await fetch(proxy);
const html=await res.text();
const doc=new DOMParser().parseFromString(html,'text/html');

const ogTitle=doc.querySelector('meta[property="og:title"]')?.content||doc.title||'';
const ogImage=doc.querySelector('meta[property="og:image"]')?.content||'';

let contentDiv=doc.querySelector('.post-body.entry-content.float-container')
||doc.querySelector('.entry-content')
||doc.querySelector('article');

let finalHTML='';

if(contentDiv){
const container=document.createElement('div');
container.innerHTML=contentDiv.innerHTML;
container.querySelectorAll('script,style,iframe,ins,.adsbygoogle').forEach(e=>e.remove());
finalHTML=container.innerHTML;
finalHTML=finalHTML.replace(/-\s*-\s*-\s*Tekst se nastavlja ispod oglasa\s*-\s*-\s*-/gi,'');
const endMsg=endings[Math.floor(Math.random()*endings.length)];
finalHTML+=`<p><strong>${endMsg}</strong></p>`;
}

processFeedPost(ogTitle,url,ogImage,finalHTML);
}

function copyRaw(text){
navigator.clipboard.writeText(text);
}

</script>
</body>
</html>
