<script>
async function getPageMetadata(url) {
    try {
        const response = await fetch(url);
        const html = await response.text();
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        
        // Dohvaćanje naslova stranice
        const title = doc.querySelector('title')?.innerText || 'Naslov nije pronađen';
        
        // Dohvaćanje Open Graph slike
        let ogImage = doc.querySelector("meta[property='og:image']")?.content;
        
        // Ako OG slika nije apsolutni link, pretvori je u apsolutni
        if (ogImage && !ogImage.startsWith('http')) {
            const urlObj = new URL(url);
            ogImage = urlObj.origin + ogImage;
        }
        
        return { title, ogImage };
    } catch (error) {
        console.error('Greška pri dohvaćanju metapodataka:', error);
        return null;
    }
}

function handleFetchMetadata() {
    const urlInput = document.getElementById('urlInput').value;
    getPageMetadata(urlInput).then(data => {
        if (data) {
            document.getElementById('title').innerText = `Naslov: ${data.title}`;
            document.getElementById('ogImage').src = data.ogImage || '';
        }
    });
}

document.addEventListener('DOMContentLoaded', () => {
    document.getElementById('fetchButton').addEventListener('click', handleFetchMetadata);
});
</script>
// HTML dio
const htmlContent = `
<!DOCTYPE html>
<html lang="hr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metadata Fetcher</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 50px;
        }
        input {
            width: 300px;
            padding: 10px;
            margin-right: 10px;
        }
        button {
            padding: 10px 20px;
            cursor: pointer;
        }
        .result {
            margin-top: 20px;
        }
        img {
            margin-top: 10px;
            width: 200px;
            height: auto;
        }
    </style>
</head>
<body>
    <h2>Unesite URL web stranice</h2>
    <input type="text" id="urlInput" placeholder="Unesite URL">
    <button id="fetchButton">Dohvati podatke</button>
    <div class="result">
        <p id="title">Naslov će se pojaviti ovdje</p>
        <img id="ogImage" src="" alt="Open Graph Slika">
    </div>
</body>
</html>`;

document.write(htmlContent);
